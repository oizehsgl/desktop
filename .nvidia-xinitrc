if [ -d /etc/X11/xinit/nvidia-xinitrc.d ]; then
  for f in /etc/X11/xinit/nvidia-xinitrc.d/?*.sh; do
    [ -x "$f" ] && . "$f"
  done
  unset f
fi

[[ -f /etc/X11/xinit/.Xresources ]] && xrdb -merge /etc/X11/xinit/.Xresources
[[ -f ~/.Xresources ]] && xrdb -merge -I$HOME ~/.Xresources

export LD_LIBRARY_PATH=/usr/lib64/nvidia/:/usr/lib32/nvidia:/usr/lib:${LD_LIBRARY_PATH}
xrandr --setprovideroutputsource modesetting NVIDIA-0
xrandr --auto

[ -f /etc/xprofile ] && source /etc/xprofile
[ -f ~/.xprofile ] && source ~/.xprofile

if [ $# -gt 0 ]; then
  $*
elif [ "graphical.target" != "$(systemctl get-default)" ]; then
  ~/bin/dual-screen-detect
  eval $(dbus-launch --sh-syntax)
  exec i3
fi
